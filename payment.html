<!DOCTYPE html>
<html lang="en" class="payment-bg">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="images/clothefav.jpeg" type="image/x-icon">
    
  <title>Payment | Trendy Clothes</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="payment-style.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.css">
  <script src="https://cdn.jsdelivr.net/npm/daisyui"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body class="bg-gray-50 payment-bg">
  <header class="navbar bg-white shadow-md px-6">
    <div class="flex-1">
      <a href="index.html#home" class="text-2xl font-bold">Trendy Clothes</a>
    </div>
  </header>
  <section class="py-10 px-6 animated fade-in" data-scroll>
    <div class="max-w-lg mx-auto bg-white rounded-xl shadow-lg p-8 animate__animated animate__fadeInDown">
      <h2 class="text-3xl font-bold text-center mb-6">Checkout & Payment</h2>
      <form id="payment-form">
        <div id="product-summary" class="mb-4 hidden">
          <div class="flex justify-between items-center bg-indigo-50 rounded-lg p-3 mb-2">
            <span class="font-semibold">Product:</span>
            <span id="summary-product" class="text-indigo-700"></span>
          </div>
          <div class="flex justify-between items-center bg-indigo-50 rounded-lg p-3">
            <span class="font-semibold">Price:</span>
            <span id="summary-price" class="text-indigo-700"></span>
          </div>
        </div>
        <div class="mb-4">
          <label class="block mb-1 font-semibold">Delivery Address</label>
          <textarea class="input input-bordered w-full min-h-[60px]" placeholder="Enter your address" required></textarea>
        </div>
        <div class="mb-4">
          <label class="block mb-1 font-semibold">Payment Options</label>
          <select id="payment-method" class="select select-bordered w-full payment-select">
            <option value="card">Credit/Debit Card</option>
            <option value="upi">UPI</option>
            <option value="cod">Cash on Delivery</option>
          </select>
        </div>
        <div id="card-fields" class="mb-4 payment-fields payment-fields-card hidden">
          <input type="text" class="input input-bordered w-full mb-2" placeholder="Card Number" required maxlength="16" minlength="16" pattern="\d{16}" title="Card number must be 16 digits" />
          <div class="flex gap-2">
            <input type="text" class="input input-bordered w-1/2" placeholder="MM/YY" required pattern="(0[1-9]|1[0-2])\/(\d{2})" title="Expiry must be in MM/YY format" />
            <input type="text" class="input input-bordered w-1/2" placeholder="CVV" required maxlength="3" minlength="3" pattern="\d{3}" title="CVV must be 3 digits" />
          </div>
        </div>
        <div id="upi-fields" class="mb-4 payment-fields payment-fields-upi">
          <label class="upi-id-label block mb-1 font-semibold" for="upi-id">UPI ID</label>
          <input id="upi-id" type="text" class="input input-bordered w-full mb-2 upi-id-field" placeholder="UPI ID (e.g. name@bank)" pattern="[^@\s]+@[^@\s]+" title="UPI ID must contain @ (e.g. name@bank)" />
          <div id="upi-id-error" class="upi-id-error text-xs text-red-500 hidden">Please enter a valid UPI ID (must contain @, e.g. name@bank).</div>
        </div>
        <div id="cod-fields" class="mb-4 payment-fields payment-fields-cod hidden">
          <p class="text-sm text-gray-600 mb-2">You will pay in cash when your order is delivered.</p>
          <input type="text" class="input input-bordered w-full mb-2" placeholder="Full Name" required />
          <input type="text" class="input input-bordered w-full mb-2" placeholder="Mobile Number" required />
          <input type="text" class="input input-bordered w-full mb-2" placeholder="Delivery Address" required />
        </div>
        <div id="payment-buttons" class="mt-6">
          <button id="pay-card" type="submit" class="btn btn-primary w-full mt-2 payment-btn hidden">Pay with Card</button>
          <button id="pay-upi" type="submit" class="btn btn-primary w-full mt-2 payment-btn hidden">Pay with UPI</button>
          <button id="pay-cod" type="submit" class="btn btn-primary w-full mt-2 payment-btn hidden">Pay with Cash</button>
        </div>
      </form>
    </div>
    <div id="payment-success" class="fixed inset-0 flex items-center justify-center z-50 hidden">
      <div class="bg-white rounded-xl shadow-lg p-8 w-full max-w-md text-center animate__animated animate__fadeInUp">
        <h2 class="text-2xl font-bold mb-2 text-green-600">Thank you for your purchase!</h2>
        <p class="mb-4">Your order has been placed successfully.<br>We hope you enjoy your new Trendy Tee!</p>
        <a href="index.html" class="btn btn-primary">Continue Shopping</a>
      </div>
    </div>
  </section>
  <script>
    // Prefill product and price from URL if present
    function getQueryParam(key) {
      const params = new URLSearchParams(window.location.search);
      return params.get(key);
    }
    const product = getQueryParam('product');
    let price = getQueryParam('price');
    let basePrice = price ? parseFloat(price) : 0;
    const summaryPrice = document.getElementById('summary-price');
    const productSummary = document.getElementById('product-summary');
    const upiInput = document.querySelector('#upi-fields input[type="text"]');
    const codFieldsInputs = document.querySelectorAll('#cod-fields input[type="text"]');

    function updateSummaryPrice(method) {
      if (!summaryPrice) return;
      if (method === 'cod') {
        summaryPrice.innerText = '₹' + (basePrice + 5);
        // Optionally, show a note about the processing fee
        if (!document.getElementById('cod-fee-note')) {
          const feeNote = document.createElement('div');
          feeNote.id = 'cod-fee-note';
          feeNote.className = 'text-xs text-gray-500 mt-1';
          feeNote.innerText = '+ ₹5 Cash on Delivery processing charge included';
          summaryPrice.parentElement.appendChild(feeNote);
        }
      } else {
        summaryPrice.innerText = '₹' + basePrice;
        const feeNote = document.getElementById('cod-fee-note');
        if (feeNote) feeNote.remove();
      }
    }

    if (product && price) {
      productSummary.classList.remove('hidden');
      document.getElementById('summary-product').innerText = product;
      summaryPrice.innerText = '₹' + price;
    }

    // Payment method toggle for new options
    const paymentMethod = document.getElementById("payment-method");
    const cardFields = document.getElementById("card-fields");
    const upiFields = document.getElementById("upi-fields");
    const codFields = document.getElementById("cod-fields");
    const payCardBtn = document.getElementById("pay-card");
    const payUpiBtn = document.getElementById("pay-upi");
    const payCodBtn = document.getElementById("pay-cod");
    // Show only the selected payment method's fields and button
    function updatePaymentFields() {
      const method = paymentMethod.value;
      cardFields.classList.add('hidden');
      upiFields.classList.add('hidden');
      codFields.classList.add('hidden');
      upiFields.classList.remove('active'); // Always remove first
      payCardBtn.classList.add('hidden');
      payUpiBtn.classList.add('hidden');
      payCodBtn.classList.add('hidden');
      if (method === 'card') {
        cardFields.classList.remove('hidden');
        payCardBtn.classList.remove('hidden');
      }
      if (method === 'upi') {
        upiFields.classList.remove('hidden');
        upiFields.classList.add('active'); // Add active for UPI
        payUpiBtn.classList.remove('hidden');
      }
      if (method === 'cod') {
        codFields.classList.remove('hidden');
        payCodBtn.classList.remove('hidden');
      }
      // Required fields
      upiInput.required = (method === 'upi');
      codFieldsInputs.forEach(input => input.required = (method === 'cod'));
      updateSummaryPrice(method);
    }
    paymentMethod.addEventListener("change", updatePaymentFields);
    // On load
    updatePaymentFields();
    // Payment form submit
    const paymentForm = document.getElementById("payment-form");
    const paymentSuccess = document.getElementById("payment-success");

    paymentForm.addEventListener("submit", function (event) {
      event.preventDefault(); // Prevent default form submission

      const method = paymentMethod.value;
      let message = "";

      if (method === "upi") {
        const upiId = document.getElementById("upi-id").value;
        message = `Your payment via UPI ID (${upiId}) was successful. Your product will be delivered to your address.`;
      } else if (method === "card") {
        message = "Your payment via Credit/Debit Card was successful. Your product will be delivered to your address.";
      } else if (method === "cod") {
        const name = document.querySelector("#cod-fields input[placeholder='Full Name']").value;
        const address = document.querySelector("#cod-fields input[placeholder='Delivery Address']").value;
        message = `Thank you, ${name}. Your order will be delivered to: ${address}. Please keep the cash ready.`;
      }

      // Display success message
      paymentSuccess.innerHTML = `
        <div class="text-center">
          <h2 class="text-2xl font-bold mb-2 text-green-600">Thank you for your purchase!</h2>
          <p class="mb-4">${message}</p>
          <button class="btn btn-primary" id="close-success">Continue Shopping</button>
        </div>
      `;
      paymentSuccess.classList.remove("hidden");

      // Close success message
      document.getElementById("close-success").addEventListener("click", function () {
        paymentSuccess.classList.add("hidden");
      });
    });
    // UPI ID validation on submit
    paymentForm.addEventListener('submit', function(e) {
      if (paymentMethod.value === 'upi') {
        const upiId = document.getElementById('upi-id').value.trim();
        const upiPattern = /@/;
        const upiError = document.getElementById('upi-id-error');
        if (!upiPattern.test(upiId)) {
          e.preventDefault();
          upiError.classList.remove('hidden');
          document.getElementById('upi-id').focus();
          return false;
        } else {
          upiError.classList.add('hidden');
        }
      }
      paymentSuccess.classList.remove("hidden");
      setTimeout(() => {
        paymentSuccess.classList.add("animate__fadeOutDown");
      }, 2000);
      setTimeout(() => {
        paymentSuccess.classList.add("hidden");
        paymentSuccess.classList.remove("animate__fadeOutDown");
      }, 2500);
    });
    // Animate.css + ScrollReveal/AOS-like effect
    function revealOnScroll() {
      document.querySelectorAll('[data-scroll]').forEach(el => {
        const rect = el.getBoundingClientRect();
        if (rect.top < window.innerHeight - 60) {
          el.classList.add('revealed');
        }
      });
    }
    window.addEventListener('scroll', revealOnScroll);
    window.addEventListener('DOMContentLoaded', revealOnScroll);
  </script>
</body>
</html>
